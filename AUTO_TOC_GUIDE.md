# HÆ°á»›ng dáº«n Tá»± Ä‘á»™ng táº¡o Má»¥c lá»¥c (Auto Table of Contents)

## Tá»•ng quan

TÃ­nh nÄƒng má»›i Ä‘Ã£ Ä‘Æ°á»£c thÃªm vÃ o component `HandBookDetail.js` Ä‘á»ƒ tá»± Ä‘á»™ng táº¡o Table of Contents tá»« cÃ¡c tiÃªu Ä‘á» trong ná»™i dung Markdown/HTML. Äiá»u nÃ y loáº¡i bá» sá»± phá»¥ thuá»™c vÃ o database vÃ  Ä‘áº£m báº£o TOC luÃ´n Ä‘á»“ng bá»™ vá»›i ná»™i dung.

## CÃ¡c tÃ­nh nÄƒng chÃ­nh

### 1. **Tá»± Ä‘á»™ng phÃ¡t hiá»‡n tiÃªu Ä‘á»**
- QuÃ©t táº¥t cáº£ headings (h1-h6) trong ná»™i dung HTML
- Tá»± Ä‘á»™ng táº¡o ID cho má»—i heading
- PhÃ¢n cáº¥p theo level cá»§a heading

### 2. **PhÃ¢n cáº¥p thÃ´ng minh**
- H1: TiÃªu Ä‘á» chÃ­nh (font-weight: 600, font-size: 15px)
- H2: TiÃªu Ä‘á» phá»¥ (font-weight: 500, font-size: 14px)
- H3: TiÃªu Ä‘á» con (font-weight: 400, font-size: 13px)
- H4-H6: TiÃªu Ä‘á» nhá» (font-weight: 400, font-size: 12px)

### 3. **Visual Hierarchy**
- Indent khÃ¡c nhau cho má»—i level
- MÃ u sáº¯c vÃ  font-weight phÃ¢n biá»‡t
- Hover effects nháº¥t quÃ¡n

## CÃ¡ch hoáº¡t Ä‘á»™ng

### 1. **Táº¡o TOC tá»« ná»™i dung**
```javascript
generateTOCFromContent = (contentHTML) => {
  if (!contentHTML) return [];

  const tempDiv = document.createElement('div');
  tempDiv.innerHTML = contentHTML;

  const headings = tempDiv.querySelectorAll('h1, h2, h3, h4, h5, h6');
  const toc = [];

  headings.forEach((heading, index) => {
    const text = heading.textContent.trim();
    if (text) {
      toc.push({
        id: `section-${index}`,
        text: text,
        level: parseInt(heading.tagName.charAt(1)),
        tagName: heading.tagName.toLowerCase()
      });
    }
  });

  return toc;
};
```

### 2. **Render TOC vá»›i phÃ¢n cáº¥p**
```javascript
{autoGeneratedTOC.map((item, idx) => (
  <li key={item.id} className={`toc-item toc-level-${item.level}`}>
    <button
      className="toc-link"
      onClick={() => this.scrollToSection(item.text, idx)}
      title={`Cuá»™n Ä‘áº¿n: ${item.text}`}
    >
      {item.text}
    </button>
  </li>
))}
```

### 3. **CSS Styling cho tá»«ng level**
```scss
.toc-level-1 {
  .toc-link {
    font-weight: 600;
    font-size: 15px;
    color: #2c3e50;
    padding-left: 1rem;
  }
}

.toc-level-2 {
  .toc-link {
    font-weight: 500;
    font-size: 14px;
    color: #495057;
    padding-left: 2rem;
  }
}

.toc-level-3 {
  .toc-link {
    font-weight: 400;
    font-size: 13px;
    color: #6c757d;
    padding-left: 3rem;
  }
}
```

## VÃ­ dá»¥ Markdown

### Input Markdown:
```markdown
# Giá»›i thiá»‡u vá» sá»©c khá»e

## Dinh dÆ°á»¡ng cÆ¡ báº£n

### Protein
Protein lÃ  cháº¥t dinh dÆ°á»¡ng quan trá»ng...

### Carbohydrate
Carbohydrate cung cáº¥p nÄƒng lÆ°á»£ng...

## Táº­p luyá»‡n thá»ƒ thao

### Cardio
Táº­p cardio giÃºp tÄƒng cÆ°á»ng tim máº¡ch...

### Strength Training
Táº­p luyá»‡n sá»©c máº¡nh giÃºp xÃ¢y dá»±ng cÆ¡ báº¯p...

#### CÃ¡c bÃ i táº­p cÆ¡ báº£n
- Squat
- Deadlift
- Bench Press

## Káº¿t luáº­n
```

### Output TOC:
```
ðŸ“‹ Ná»™i dung chÃ­nh
â”œâ”€â”€ Giá»›i thiá»‡u vá» sá»©c khá»e (H1)
â”œâ”€â”€ Dinh dÆ°á»¡ng cÆ¡ báº£n (H2)
â”‚   â”œâ”€â”€ Protein (H3)
â”‚   â””â”€â”€ Carbohydrate (H3)
â”œâ”€â”€ Táº­p luyá»‡n thá»ƒ thao (H2)
â”‚   â”œâ”€â”€ Cardio (H3)
â”‚   â”œâ”€â”€ Strength Training (H3)
â”‚   â””â”€â”€ CÃ¡c bÃ i táº­p cÆ¡ báº£n (H4)
â””â”€â”€ Káº¿t luáº­n (H2)
```

## Lá»£i Ã­ch

### 1. **Tá»± Ä‘á»™ng hÃ³a**
- KhÃ´ng cáº§n nháº­p TOC thá»§ cÃ´ng
- LuÃ´n Ä‘á»“ng bá»™ vá»›i ná»™i dung
- Giáº£m lá»—i vÃ  thiáº¿u sÃ³t

### 2. **TÃ­nh nháº¥t quÃ¡n**
- Format thá»‘ng nháº¥t cho táº¥t cáº£ bÃ i viáº¿t
- PhÃ¢n cáº¥p rÃµ rÃ ng
- UX nháº¥t quÃ¡n

### 3. **Dá»… báº£o trÃ¬**
- KhÃ´ng cáº§n cáº­p nháº­t database
- Tá»± Ä‘á»™ng cáº­p nháº­t khi ná»™i dung thay Ä‘á»•i
- Ãt code hÆ¡n Ä‘á»ƒ maintain

## Cáº¥u trÃºc dá»¯ liá»‡u

### TOC Item Object:
```javascript
{
  id: "section-0",           // ID duy nháº¥t
  text: "Giá»›i thiá»‡u",        // Text hiá»ƒn thá»‹
  level: 1,                  // Level cá»§a heading (1-6)
  tagName: "h1"              // Tag name gá»‘c
}
```

### TOC Array:
```javascript
[
  { id: "section-0", text: "Giá»›i thiá»‡u", level: 1, tagName: "h1" },
  { id: "section-1", text: "Dinh dÆ°á»¡ng", level: 2, tagName: "h2" },
  { id: "section-2", text: "Protein", level: 3, tagName: "h3" },
  // ...
]
```

## Styling Details

### 1. **Level-based Styling**
- **Level 1 (H1)**: Bold, large, dark color
- **Level 2 (H2)**: Medium weight, medium size
- **Level 3 (H3)**: Normal weight, smaller size
- **Level 4-6 (H4-H6)**: Light weight, smallest size

### 2. **Indentation**
- Level 1: 1rem padding-left
- Level 2: 2rem padding-left
- Level 3: 3rem padding-left
- Level 4-6: 4rem padding-left

### 3. **Color Scheme**
- Level 1: #2c3e50 (Dark)
- Level 2: #495057 (Medium)
- Level 3-6: #6c757d (Light)

## Performance Considerations

### 1. **Efficient Processing**
- Sá»­ dá»¥ng DOM parsing má»™t láº§n
- Cache TOC trong component state
- Chá»‰ regenerate khi content thay Ä‘á»•i

### 2. **Memory Management**
- Cleanup temp div sau khi parse
- KhÃ´ng lÆ°u trá»¯ DOM elements
- Sá»­ dá»¥ng lightweight objects

### 3. **Rendering Optimization**
- Virtual scrolling cho TOC dÃ i
- Lazy loading náº¿u cáº§n
- Debounced updates

## Migration tá»« Database TOC

### 1. **Backward Compatibility**
```javascript
// Kiá»ƒm tra cáº£ TOC tá»« DB vÃ  auto-generated
const toc = data.toc && data.toc.length > 0 
  ? data.toc 
  : this.generateTOCFromContent(data.contentHTML);
```

### 2. **Database Cleanup**
- CÃ³ thá»ƒ remove field `toc` tá»« database
- Update API Ä‘á»ƒ khÃ´ng tráº£ vá» `toc`
- Update frontend Ä‘á»ƒ chá»‰ sá»­ dá»¥ng auto-generated TOC

### 3. **Testing Strategy**
- Test vá»›i cÃ¡c loáº¡i content khÃ¡c nhau
- Verify TOC generation accuracy
- Test performance vá»›i content dÃ i

## Troubleshooting

### 1. **TOC khÃ´ng hiá»ƒn thá»‹**
**NguyÃªn nhÃ¢n:** KhÃ´ng cÃ³ headings trong content
**Giáº£i phÃ¡p:** Kiá»ƒm tra content HTML cÃ³ headings khÃ´ng

### 2. **TOC khÃ´ng Ä‘Ãºng thá»© tá»±**
**NguyÃªn nhÃ¢n:** Headings khÃ´ng theo thá»© tá»± trong HTML
**Giáº£i phÃ¡p:** Äáº£m báº£o headings Ä‘Æ°á»£c sáº¯p xáº¿p Ä‘Ãºng trong content

### 3. **Performance issues**
**NguyÃªn nhÃ¢n:** Content quÃ¡ dÃ i hoáº·c nhiá»u headings
**Giáº£i phÃ¡p:** Implement virtual scrolling hoáº·c pagination

### 4. **Styling khÃ´ng Ä‘Ãºng**
**NguyÃªn nhÃ¢n:** CSS khÃ´ng Ä‘Æ°á»£c load hoáº·c conflict
**Giáº£i phÃ¡p:** Kiá»ƒm tra CSS specificity vÃ  load order

## Future Enhancements

### 1. **TÃ­nh nÄƒng cÃ³ thá»ƒ thÃªm**
- **Collapsible TOC**: Thu gá»n/má»Ÿ rá»™ng sections
- **Search TOC**: TÃ¬m kiáº¿m trong TOC
- **Sticky TOC**: TOC cá»‘ Ä‘á»‹nh khi scroll
- **Active section highlighting**: Highlight section hiá»‡n táº¡i

### 2. **Advanced Features**
- **Nested TOC**: Hiá»ƒn thá»‹ cáº¥u trÃºc lá»“ng nhau
- **TOC with icons**: Icons cho tá»«ng loáº¡i heading
- **Custom TOC templates**: Template tÃ¹y chá»‰nh
- **Export TOC**: Xuáº¥t TOC ra file

### 3. **Analytics**
- **TOC usage tracking**: Theo dÃµi click patterns
- **Scroll depth analysis**: PhÃ¢n tÃ­ch Ä‘á»™ sÃ¢u Ä‘á»c
- **User engagement metrics**: Metrics tÆ°Æ¡ng tÃ¡c

## Code Examples

### 1. **Basic TOC Generation**
```javascript
const toc = this.generateTOCFromContent(contentHTML);
console.log('Generated TOC:', toc);
```

### 2. **Custom TOC Filtering**
```javascript
// Chá»‰ láº¥y H1 vÃ  H2
const filteredTOC = toc.filter(item => item.level <= 2);
```

### 3. **TOC with Custom Styling**
```javascript
// Custom styling cho tá»«ng level
const getTOCStyle = (level) => {
  const styles = {
    1: { fontWeight: 'bold', fontSize: '16px' },
    2: { fontWeight: '500', fontSize: '14px' },
    3: { fontWeight: 'normal', fontSize: '13px' }
  };
  return styles[level] || styles[3];
};
```

---

**Version:** 2.0.0  
**Last Updated:** January 2024  
**Author:** Development Team
